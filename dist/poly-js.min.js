!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=0,this.y=0;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=this._checkParams(n);this.x=i.x,this.y=i.y,this.next=null,this.prev=null}var t,n,o;return t=e,o=[{key:"Distance",value:function(e,t){var n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return Math.sqrt(n*n+r*r)}},{key:"Max",value:function(t,n){return new e(Math.max(t.x,n.x),Math.max(t.y,n.y))}},{key:"Min",value:function(t,n){return new e(Math.min(t.x,n.x),Math.min(t.y,n.y))}},{key:"Lerp",value:function(t,n,r){return r>1?r=1:r<0&&(r=0),e.LerpUnclamped(t,n,r)}},{key:"LerpUnclamped",value:function(e,t,n){var r=t.clone.substract(e).multiply(n);return e.clone.add(r)}},{key:"IsVector2Like",value:function(t){return"object"===r(t)&&void 0!==t.x&&void 0!==t.y&&(t instanceof e?t:new e(t))}}],(n=[{key:"floor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.floorX(e),this.floorY(e),this}},{key:"floorX",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.x=Math.floor(this.x*e)/e,this}},{key:"floorY",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.y=Math.floor(this.y*e)/e,this}},{key:"ceil",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.ceilX(e),this.ceilY(e),this}},{key:"ceilX",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.x=Math.ceil(this.x*e)/e,this}},{key:"ceilY",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.y=Math.ceil(this.y*e)/e,this}},{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.roundX(e),this.roundY(e),this}},{key:"roundX",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.x=Math.round(this.x*e)/e,this}},{key:"roundY",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.y=Math.round(this.y*e)/e,this}},{key:"set",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this._checkParams(t);return this.setX(r.x),this.setY(r.y),this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this._checkParams(t);return this.addX(r.x),this.addY(r.y),this}},{key:"addX",value:function(e){return this.x+=e,this}},{key:"addY",value:function(e){return this.y+=e,this}},{key:"substract",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this._checkParams(t);return this.substractX(r.x),this.substractY(r.y),this}},{key:"substractX",value:function(e){return this.x-=e,this}},{key:"substractY",value:function(e){return this.y-=e,this}},{key:"multiply",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this._checkParams(t);return this.multiplyX(r.x),this.multiplyY(r.y),this}},{key:"multiplyX",value:function(e){return this.x*=e,this}},{key:"multiplyY",value:function(e){return this.y*=e,this}},{key:"divide",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this._checkParams(t);return this.divideX(r.x),this.divideY(r.y),this}},{key:"divideX",value:function(e){return this.x/=e,this}},{key:"divideY",value:function(e){return this.y/=e,this}},{key:"invert",value:function(){return this.invertX(),this.invertY(),this}},{key:"invertX",value:function(){return this.x=0-this.x,this}},{key:"invertY",value:function(){return this.y=0-this.y,this}},{key:"rotate",value:function(e){e*=Math.PI/180;var t=Math.cos(e),n=Math.sin(e),r=1*this.x,i=1*this.y;return this.x=r*t-i*n,this.y=r*n+i*t,this.approximate(),this}},{key:"equals",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this._checkParams(t);return this.equalsX(r.x)&&this.equalsY(r.y)}},{key:"equalsX",value:function(e){return this.x===e}},{key:"equalsY",value:function(e){return this.y===e}},{key:"isInside",value:function(e){return e.pointIsInside(this)}},{key:"approximate",value:function(){return this.setX(Math.round(1e4*this.x)/1e4).setY(Math.round(1e4*this.y)/1e4),this}},{key:"toString",value:function(){return JSON.stringify({x:this.x,y:this.y})}},{key:"_checkParams",value:function(e){var t=e[0],n=e[1],i={x:0,y:0};return null!==t&&"object"===r(t)?void 0!==t.x&&void 0!==t.y&&(i.x=1*t.x,i.y=1*t.y):void 0!==t&&void 0!==n?(i.x=1*t,i.y=1*n):void 0!==t&&(i.x=1*t,i.y=1*t),i}},{key:"approximated",get:function(){return this.clone.approximate()}},{key:"normalized",get:function(){return this.divide(this.magnitude)}},{key:"norm",get:function(){return this.normalized}},{key:"magnitude",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"clone",get:function(){return new e(this.x,this.y)}}])&&i(t.prototype,n),o&&i(t,o),e}();o.Zero=function(){return new o(0,0)},o.Top=function(){return new o(0,-1)},o.Left=function(){return new o(-1,0)},o.Bottom=function(){return new o(0,1)},o.Right=function(){return new o(1,0)},e.exports=o},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=n(4),o=n(2),u=n(0),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.children=[],this.first=null,t&&t.length){var n=!0,r=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;this.addVertex(s)}}catch(e){r=!0,i=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw i}}}}var t,n,s;return t=e,s=[{key:"Colliding",value:function(e,t){var n=e.points,r=t.points,i=!0,o=!1,u=void 0;try{for(var s,a=n[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var l=s.value;if(t.pointIsInside(l))return!0}}catch(e){o=!0,u=e}finally{try{i||null==a.return||a.return()}finally{if(o)throw u}}var c=!0,f=!1,h=void 0;try{for(var v,y=r[Symbol.iterator]();!(c=(v=y.next()).done);c=!0){var d=v.value;if(e.pointIsInside(d))return!0}}catch(e){f=!0,h=e}finally{try{c||null==y.return||y.return()}finally{if(f)throw h}}return!1}},{key:"FromRegion",value:function(t){return new e(t.map((function(e){return new u(e[0],e[1])})))}},{key:"Intersect",value:function(t,n){return i.intersect({regions:[t.region],inverted:!1},{regions:[n.region],inverted:!1}).regions.map((function(t){return e.FromRegion(t)}))}},{key:"Union",value:function(t,n){return i.union({regions:[t.region],inverted:!1},{regions:[n.region],inverted:!1}).regions.map((function(t){return e.FromRegion(t)}))}},{key:"Difference",value:function(t,n){return i.difference({regions:[t.region],inverted:!1},{regions:[n.region],inverted:!1}).regions.map((function(t){return e.FromRegion(t)}))}},{key:"Xor",value:function(t,n){return i.xor({regions:[t.region],inverted:!1},{regions:[n.region],inverted:!1}).regions.map((function(t){return e.FromRegion(t)}))}}],(n=[{key:"pointIsInside",value:function(e){return this.pointIsInsidePolygon(e)}},{key:"pointIsInsidePolygon",value:function(e){var t=!1,n=this.first,r=n.next,i=e.x,o=e.y;do{(n.y<o&&r.y>=o||r.y<o&&n.y>=o)&&(n.x<=i||r.x<=i)&&(t^=n.x+(o-n.y)/(r.y-n.y)*(r.x-n.x)<i),r=(n=n.next).next||this.first}while(!n.equals(this.first));return t}},{key:"setChildren",value:function(e){return this.children=e,this}},{key:"addChild",value:function(e){return this.children.push(e),this}},{key:"setVertexes",value:function(e){this.first=null;var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var u=i.value;this.addVertex(u)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return this}},{key:"addVertex",value:function(e){if(null===this.first)this.first=e,this.first.next=e,this.first.prev=e;else{var t=this.first,n=t.prev;t.prev=e,e.next=t,e.prev=n,n.next=e}return this}},{key:"colliding",value:function(t){return e.Colliding(this,t)}},{key:"intersect",value:function(t){return e.Intersect(this,t)}},{key:"difference",value:function(t){return e.Difference(this,t)}},{key:"union",value:function(t){return e.Union(this,t)}},{key:"xor",value:function(t){return e.Xor(this,t)}},{key:"region",get:function(){return this.points.map((function(e){return[e.x,e.y]}))}},{key:"points",get:function(){var e=[],t=this.first;do{e.push(t),t=t.next}while(!t.equals(this.first));return e}},{key:"lines",get:function(){var e=[],t=null,n=this.first;do{null!==t&&e.push(new o(t,n)),t=n,n=n.next}while(!n.equals(this.first));return e}},{key:"area",get:function(){var e=0,t=this.first;do{e+=t.x*t.next.y-t.y*t.next.x,t=t.next}while(!t.equals(this.first));var n=e/2;if(this.children&&this.children.length){var r=!0,i=!1,o=void 0;try{for(var u,s=this.children[Symbol.iterator]();!(r=(u=s.next()).done);r=!0)n-=u.value.area}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}return Math.abs(n)}}])&&r(t.prototype,n),s&&r(t,s),e}();e.exports=s},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=n(0),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.start=new i.Zero,this.end=new i.Zero;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._checkParams(n)}var t,n,o;return t=e,o=[{key:"Intersect",value:function(e,t){var n=e.start.x,r=e.start.y,o=e.end.x,u=e.end.y,s=t.start.x,a=t.start.y,l=o-n,c=u-r,f=t.end.x-s,h=t.end.y-a,v=(-c*(n-s)+l*(r-a))/(-f*c+l*h),y=(f*(r-a)-h*(n-s))/(-f*c+l*h),d=new i.Zero;return v>=0&&v<=1&&y>=0&&y<=1&&(d.x=n+y*l,d.y=r+y*c,d)}}],(n=[{key:"intersect",value:function(t){return e.Intersect(this,t)}},{key:"alongPoint",value:function(e){return i.Lerp(this.start,this.end,e)}},{key:"alongPointUnclamped",value:function(e){return i.LerpUnclamped(this.start,this.end,e)}},{key:"_checkParams",value:function(e){var t=i.IsVector2Like(e[0]),n=i.IsVector2Like(e[1]);t&&n?(this.start=t,this.end=n):t&&(this.end=t)}},{key:"length",get:function(){return i.Distance(this.end,this.start)}}])&&r(t.prototype,n),o&&r(t,o),e}();e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(1),u=n(12),s=n(13);e.exports={Vector2:r,Line:i,Polygon:o,Rect:u,Circle:s}},function(e,t,n){
/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */
var r,i=n(5),o=n(6),u=n(7),s=n(9),a=n(10),l=n(11),c=!1,f=o();function h(e,t,n){var i=r.segments(e),o=r.segments(t),u=n(r.combine(i,o));return r.polygon(u)}r={buildLog:function(e){return!0===e?c=i():!1===e&&(c=!1),!1!==c&&c.list},epsilon:function(e){return f.epsilon(e)},segments:function(e){var t=u(!0,f,c);return e.regions.forEach(t.addRegion),{segments:t.calculate(e.inverted),inverted:e.inverted}},combine:function(e,t){return{combined:u(!1,f,c).calculate(e.segments,e.inverted,t.segments,t.inverted),inverted1:e.inverted,inverted2:t.inverted}},selectUnion:function(e){return{segments:a.union(e.combined,c),inverted:e.inverted1||e.inverted2}},selectIntersect:function(e){return{segments:a.intersect(e.combined,c),inverted:e.inverted1&&e.inverted2}},selectDifference:function(e){return{segments:a.difference(e.combined,c),inverted:e.inverted1&&!e.inverted2}},selectDifferenceRev:function(e){return{segments:a.differenceRev(e.combined,c),inverted:!e.inverted1&&e.inverted2}},selectXor:function(e){return{segments:a.xor(e.combined,c),inverted:e.inverted1!==e.inverted2}},polygon:function(e){return{regions:s(e.segments,f,c),inverted:e.inverted}},polygonFromGeoJSON:function(e){return l.toPolygon(r,e)},polygonToGeoJSON:function(e){return l.fromPolygon(r,f,e)},union:function(e,t){return h(e,t,r.selectUnion)},intersect:function(e,t){return h(e,t,r.selectIntersect)},difference:function(e,t){return h(e,t,r.selectDifference)},differenceRev:function(e,t){return h(e,t,r.selectDifferenceRev)},xor:function(e,t){return h(e,t,r.selectXor)}},"object"==typeof window&&(window.PolyBool=r),e.exports=r},function(e,t){e.exports=function(){var e,t=0,n=!1;function r(t,n){return e.list.push({type:t,data:n?JSON.parse(JSON.stringify(n)):void 0}),e}return e={list:[],segmentId:function(){return t++},checkIntersection:function(e,t){return r("check",{seg1:e,seg2:t})},segmentChop:function(e,t){return r("div_seg",{seg:e,pt:t}),r("chop",{seg:e,pt:t})},statusRemove:function(e){return r("pop_seg",{seg:e})},segmentUpdate:function(e){return r("seg_update",{seg:e})},segmentNew:function(e,t){return r("new_seg",{seg:e,primary:t})},segmentRemove:function(e){return r("rem_seg",{seg:e})},tempStatus:function(e,t,n){return r("temp_status",{seg:e,above:t,below:n})},rewind:function(e){return r("rewind",{seg:e})},status:function(e,t,n){return r("status",{seg:e,above:t,below:n})},vert:function(t){return t===n?e:(n=t,r("vert",{x:t}))},log:function(e){return"string"!=typeof e&&(e=JSON.stringify(e,!1,"  ")),r("log",{txt:e})},reset:function(){return r("reset")},selected:function(e){return r("selected",{segs:e})},chainStart:function(e){return r("chain_start",{seg:e})},chainRemoveHead:function(e,t){return r("chain_rem_head",{index:e,pt:t})},chainRemoveTail:function(e,t){return r("chain_rem_tail",{index:e,pt:t})},chainNew:function(e,t){return r("chain_new",{pt1:e,pt2:t})},chainMatch:function(e){return r("chain_match",{index:e})},chainClose:function(e){return r("chain_close",{index:e})},chainAddHead:function(e,t){return r("chain_add_head",{index:e,pt:t})},chainAddTail:function(e,t){return r("chain_add_tail",{index:e,pt:t})},chainConnect:function(e,t){return r("chain_con",{index1:e,index2:t})},chainReverse:function(e){return r("chain_rev",{index:e})},chainJoin:function(e,t){return r("chain_join",{index1:e,index2:t})},done:function(){return r("done")}}}},function(e,t){e.exports=function(e){"number"!=typeof e&&(e=1e-10);var t={epsilon:function(t){return"number"==typeof t&&(e=t),e},pointAboveOrOnLine:function(t,n,r){var i=n[0],o=n[1],u=r[0],s=r[1],a=t[0];return(u-i)*(t[1]-o)-(s-o)*(a-i)>=-e},pointBetween:function(t,n,r){var i=t[1]-n[1],o=r[0]-n[0],u=t[0]-n[0],s=r[1]-n[1],a=u*o+i*s;return!(a<e)&&!(a-(o*o+s*s)>-e)},pointsSameX:function(t,n){return Math.abs(t[0]-n[0])<e},pointsSameY:function(t,n){return Math.abs(t[1]-n[1])<e},pointsSame:function(e,n){return t.pointsSameX(e,n)&&t.pointsSameY(e,n)},pointsCompare:function(e,n){return t.pointsSameX(e,n)?t.pointsSameY(e,n)?0:e[1]<n[1]?-1:1:e[0]<n[0]?-1:1},pointsCollinear:function(t,n,r){var i=t[0]-n[0],o=t[1]-n[1],u=n[0]-r[0],s=n[1]-r[1];return Math.abs(i*s-u*o)<e},linesIntersect:function(t,n,r,i){var o=n[0]-t[0],u=n[1]-t[1],s=i[0]-r[0],a=i[1]-r[1],l=o*a-u*s;if(Math.abs(l)<e)return!1;var c=t[0]-r[0],f=t[1]-r[1],h=(s*f-a*c)/l,v=(o*f-u*c)/l,y={alongA:0,alongB:0,pt:[t[0]+h*o,t[1]+h*u]};return y.alongA=h<=-e?-2:h<e?-1:h-1<=-e?0:h-1<e?1:2,y.alongB=v<=-e?-2:v<e?-1:v-1<=-e?0:v-1<e?1:2,y},pointInsideRegion:function(t,n){for(var r=t[0],i=t[1],o=n[n.length-1][0],u=n[n.length-1][1],s=!1,a=0;a<n.length;a++){var l=n[a][0],c=n[a][1];c-i>e!=u-i>e&&(o-l)*(i-c)/(u-c)+l-r>e&&(s=!s),o=l,u=c}return s}};return t}},function(e,t,n){var r=n(8);e.exports=function(e,t,n){function i(e,t,r){return{id:n?n.segmentId():-1,start:e,end:t,myFill:{above:r.myFill.above,below:r.myFill.below},otherFill:null}}var o=r.create();function u(e,n){o.insertBefore(e,(function(r){return function(e,n,r,i,o,u){var s=t.pointsCompare(n,o);return 0!==s?s:t.pointsSame(r,u)?0:e!==i?e?1:-1:t.pointAboveOrOnLine(r,i?o:u,i?u:o)?1:-1}(e.isStart,e.pt,n,r.isStart,r.pt,r.other.pt)<0}))}function s(e,t){var n=function(e,t){var n=r.node({isStart:!0,pt:e.start,seg:e,primary:t,other:null,status:null});return u(n,e.end),n}(e,t);return function(e,t,n){var i=r.node({isStart:!1,pt:t.end,seg:t,primary:n,other:e,status:null});e.other=i,u(i,e.pt)}(n,e,t),n}function a(e,t){var r=i(t,e.seg.end,e.seg);return function(e,t){n&&n.segmentChop(e.seg,t),e.other.remove(),e.seg.end=t,e.other.pt=t,u(e.other,e.pt)}(e,t),s(r,e.primary)}function l(i,u){var s=r.create();function l(e){return s.findTransition((function(n){var r,i,o,u,s,a;return(r=e,i=n.ev,o=r.seg.start,u=r.seg.end,s=i.seg.start,a=i.seg.end,t.pointsCollinear(o,s,a)?t.pointsCollinear(u,s,a)?1:t.pointAboveOrOnLine(u,s,a)?1:-1:t.pointAboveOrOnLine(o,s,a)?1:-1)>0}))}function c(e,r){var i=e.seg,o=r.seg,u=i.start,s=i.end,l=o.start,c=o.end;n&&n.checkIntersection(i,o);var f=t.linesIntersect(u,s,l,c);if(!1===f){if(!t.pointsCollinear(u,s,l))return!1;if(t.pointsSame(u,c)||t.pointsSame(s,l))return!1;var h=t.pointsSame(u,l),v=t.pointsSame(s,c);if(h&&v)return r;var y=!h&&t.pointBetween(u,l,c),d=!v&&t.pointBetween(s,l,c);if(h)return d?a(r,s):a(e,c),r;y&&(v||(d?a(r,s):a(e,c)),a(r,u))}else 0===f.alongA&&(-1===f.alongB?a(e,l):0===f.alongB?a(e,f.pt):1===f.alongB&&a(e,c)),0===f.alongB&&(-1===f.alongA?a(r,u):0===f.alongA?a(r,f.pt):1===f.alongA&&a(r,s));return!1}for(var f=[];!o.isEmpty();){var h=o.getHead();if(n&&n.vert(h.pt[0]),h.isStart){n&&n.segmentNew(h.seg,h.primary);var v=l(h),y=v.before?v.before.ev:null,d=v.after?v.after.ev:null;function p(){if(y){var e=c(h,y);if(e)return e}return!!d&&c(h,d)}n&&n.tempStatus(h.seg,!!y&&y.seg,!!d&&d.seg);var g,m=p();if(m){var x;if(e)(x=null===h.seg.myFill.below||h.seg.myFill.above!==h.seg.myFill.below)&&(m.seg.myFill.above=!m.seg.myFill.above);else m.seg.otherFill=h.seg.myFill;n&&n.segmentUpdate(m.seg),h.other.remove(),h.remove()}if(o.getHead()!==h){n&&n.rewind(h.seg);continue}if(e)x=null===h.seg.myFill.below||h.seg.myFill.above!==h.seg.myFill.below,h.seg.myFill.below=d?d.seg.myFill.above:i,h.seg.myFill.above=x?!h.seg.myFill.below:h.seg.myFill.below;else if(null===h.seg.otherFill)g=d?h.primary===d.primary?d.seg.otherFill.above:d.seg.myFill.above:h.primary?u:i,h.seg.otherFill={above:g,below:g};n&&n.status(h.seg,!!y&&y.seg,!!d&&d.seg),h.other.status=v.insert(r.node({ev:h}))}else{var b=h.status;if(null===b)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(s.exists(b.prev)&&s.exists(b.next)&&c(b.prev.ev,b.next.ev),n&&n.statusRemove(b.ev.seg),b.remove(),!h.primary){var _=h.seg.myFill;h.seg.myFill=h.seg.otherFill,h.seg.otherFill=_}f.push(h.seg)}o.getHead().remove()}return n&&n.done(),f}return e?{addRegion:function(e){for(var r,i,o,u=e[e.length-1],a=0;a<e.length;a++){r=u,u=e[a];var l=t.pointsCompare(r,u);0!==l&&s((i=l<0?r:u,o=l<0?u:r,{id:n?n.segmentId():-1,start:i,end:o,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(e){return l(e,!1)}}:{calculate:function(e,t,n,r){return e.forEach((function(e){s(i(e.start,e.end,e),!0)})),n.forEach((function(e){s(i(e.start,e.end,e),!1)})),l(t,r)}}}},function(e,t){e.exports={create:function(){var e={root:{root:!0,next:null},exists:function(t){return null!==t&&t!==e.root},isEmpty:function(){return null===e.root.next},getHead:function(){return e.root.next},insertBefore:function(t,n){for(var r=e.root,i=e.root.next;null!==i;){if(n(i))return t.prev=i.prev,t.next=i,i.prev.next=t,void(i.prev=t);r=i,i=i.next}r.next=t,t.prev=r,t.next=null},findTransition:function(t){for(var n=e.root,r=e.root.next;null!==r&&!t(r);)n=r,r=r.next;return{before:n===e.root?null:n,after:r,insert:function(e){return e.prev=n,e.next=r,n.next=e,null!==r&&(r.prev=e),e}}}};return e},node:function(e){return e.prev=null,e.next=null,e.remove=function(){e.prev.next=e.next,e.next&&(e.next.prev=e.prev),e.prev=null,e.next=null},e}}},function(e,t){e.exports=function(e,t,n){var r=[],i=[];return e.forEach((function(e){var o=e.start,u=e.end;if(t.pointsSame(o,u))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{n&&n.chainStart(e);for(var s={index:0,matches_head:!1,matches_pt1:!1},a={index:0,matches_head:!1,matches_pt1:!1},l=s,c=0;c<r.length;c++){var f=(p=r[c])[0],h=(p[1],p[p.length-1]);p[p.length-2];if(t.pointsSame(f,o)){if(S(c,!0,!0))break}else if(t.pointsSame(f,u)){if(S(c,!0,!1))break}else if(t.pointsSame(h,o)){if(S(c,!1,!0))break}else if(t.pointsSame(h,u)&&S(c,!1,!1))break}if(l===s)return r.push([o,u]),void(n&&n.chainNew(o,u));if(l===a){n&&n.chainMatch(s.index);var v=s.index,y=s.matches_pt1?u:o,d=s.matches_head,p=r[v],g=d?p[0]:p[p.length-1],m=d?p[1]:p[p.length-2],x=d?p[p.length-1]:p[0],b=d?p[p.length-2]:p[1];return t.pointsCollinear(m,g,y)&&(d?(n&&n.chainRemoveHead(s.index,y),p.shift()):(n&&n.chainRemoveTail(s.index,y),p.pop()),g=m),t.pointsSame(x,y)?(r.splice(v,1),t.pointsCollinear(b,x,g)&&(d?(n&&n.chainRemoveTail(s.index,g),p.pop()):(n&&n.chainRemoveHead(s.index,g),p.shift())),n&&n.chainClose(s.index),void i.push(p)):void(d?(n&&n.chainAddHead(s.index,y),p.unshift(y)):(n&&n.chainAddTail(s.index,y),p.push(y)))}var _=s.index,k=a.index;n&&n.chainConnect(_,k);var w=r[_].length<r[k].length;s.matches_head?a.matches_head?w?(P(_),M(_,k)):(P(k),M(k,_)):M(k,_):a.matches_head?M(_,k):w?(P(_),M(k,_)):(P(k),M(_,k))}function S(e,t,n){return l.index=e,l.matches_head=t,l.matches_pt1=n,l===s?(l=a,!1):(l=null,!0)}function P(e){n&&n.chainReverse(e),r[e].reverse()}function M(e,i){var o=r[e],u=r[i],s=o[o.length-1],a=o[o.length-2],l=u[0],c=u[1];t.pointsCollinear(a,s,l)&&(n&&n.chainRemoveTail(e,s),o.pop(),s=a),t.pointsCollinear(s,l,c)&&(n&&n.chainRemoveHead(i,l),u.shift()),n&&n.chainJoin(e,i),r[e]=o.concat(u),r.splice(i,1)}})),i}},function(e,t){function n(e,t,n){var r=[];return e.forEach((function(e){var i=(e.myFill.above?8:0)+(e.myFill.below?4:0)+(e.otherFill&&e.otherFill.above?2:0)+(e.otherFill&&e.otherFill.below?1:0);0!==t[i]&&r.push({id:n?n.segmentId():-1,start:e.start,end:e.end,myFill:{above:1===t[i],below:2===t[i]},otherFill:null})})),n&&n.selected(r),r}var r={union:function(e,t){return n(e,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],t)},intersect:function(e,t){return n(e,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],t)},difference:function(e,t){return n(e,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],t)},differenceRev:function(e,t){return n(e,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],t)},xor:function(e,t){return n(e,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],t)}};e.exports=r},function(e,t){var n={toPolygon:function(e,t){function n(t){if(t.length<=0)return e.segments({inverted:!1,regions:[]});function n(t){var n=t.slice(0,t.length-1);return e.segments({inverted:!1,regions:[n]})}for(var r=n(t[0]),i=1;i<t.length;i++)r=e.selectDifference(e.combine(r,n(t[i])));return r}if("Polygon"===t.type)return e.polygon(n(t.coordinates));if("MultiPolygon"===t.type){for(var r=e.segments({inverted:!1,regions:[]}),i=0;i<t.coordinates.length;i++)r=e.selectUnion(e.combine(r,n(t.coordinates[i])));return e.polygon(r)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(e,t,n){function r(e,n){return t.pointInsideRegion([.5*(e[0][0]+e[1][0]),.5*(e[0][1]+e[1][1])],n)}function i(e){return{region:e,children:[]}}n=e.polygon(e.segments(n));var o=i(null);function u(e,t){for(var n=0;n<e.children.length;n++){if(r(t,(s=e.children[n]).region))return void u(s,t)}var o=i(t);for(n=0;n<e.children.length;n++){var s;r((s=e.children[n]).region,t)&&(o.children.push(s),e.children.splice(n,1),n--)}e.children.push(o)}for(var s=0;s<n.regions.length;s++){var a=n.regions[s];a.length<3||u(o,a)}function l(e,t){for(var n=0,r=e[e.length-1][0],i=e[e.length-1][1],o=[],u=0;u<e.length;u++){var s=e[u][0],a=e[u][1];o.push([s,a]),n+=a*r-s*i,r=s,i=a}return n<0!==t&&o.reverse(),o.push([o[0][0],o[0][1]]),o}var c=[];function f(e){var t=[l(e.region,!1)];c.push(t);for(var n=0;n<e.children.length;n++)t.push(h(e.children[n]))}function h(e){for(var t=0;t<e.children.length;t++)f(e.children[t]);return l(e.region,!0)}for(s=0;s<o.children.length;s++)f(o.children[s]);return c.length<=0?{type:"Polygon",coordinates:[]}:1==c.length?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}};e.exports=n},function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(0),c=n(1),f=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=u(this,s(t).call(this)))._position=l.zero,e._size=l.zero;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e._checkParams(r),e}var n,f,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,e),n=t,h=[{key:"Box",value:function(e){if(e&&"object"===i(e)&&(e instanceof c&&(e=e.points),e instanceof Array&&e.length)){var n=e.map((function(e){return e.x})),o=e.map((function(e){return e.y}));return new t(new l(Math.min.apply(Math,r(n)),Math.min.apply(Math,r(o))),new l(Math.max.apply(Math,r(n))-Math.min.apply(Math,r(n)),Math.max.apply(Math,r(o))-Math.min.apply(Math,r(o))))}return null}}],(f=[{key:"pointIsInside",value:function(e){return this.pointIsInsideRect(e)}},{key:"pointIsInsideRect",value:function(e){var t=this._position,n=this._position.clone.add(this._size),r=new l(Math.min(t.x,n.x),Math.min(t.y,n.y)),i=new l(Math.max(t.x,n.x),Math.max(t.y,n.y));return e.x>=r.x&&e.x<=i.x&&e.y>=r.y&&e.y<=i.y}},{key:"_checkParams",value:function(e){var t=l.IsVector2Like(e[0])||e[0],n=l.IsVector2Like(e[1])||e[1],r=e[2],o=e[3];t&&"object"===i(t)&&n&&"object"===i(n)?(this._position=t,this._size=n):t&&void 0!==t&&"object"!==i(t)&&n&&void 0!==n&&"object"!==i(n)&&r&&void 0!==r&&"object"!==i(r)&&o&&void 0!==o&&"object"!==i(o)&&(this._position.x=t,this._position.y=n,this._size.x=r,this._size.y=o),this._calcPoly()}},{key:"_calcPoly",value:function(){this.setVertexes([this._position,this._position.clone.add(new l(this._size.x,0)),this._position.clone.add(this._size),this._position.clone.add(new l(0,this._size.y))])}},{key:"position",get:function(){return this._position},set:function(e){this._position=e,this._calcPoly()}},{key:"size",get:function(){return this._size},set:function(e){this._size=e,this._calcPoly()}}])&&o(n.prototype,f),h&&o(n,h),t}(c);e.exports=f},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(1),l=n(0),c=function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=o(this,u(t).call(this)))._center=e,i._radius=Math.abs(n),i._sides=parseInt(r),i._sides<3&&(i._sides=3),i._radius<=0&&(i._radius=1),i._calc(),i}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,e),n=t,(r=[{key:"pointIsInside",value:function(e){return this.pointIsInsideCircle(e)}},{key:"pointIsInsideCircle",value:function(e){return l.Distance(this._center,e)<=this._radius}},{key:"_calc",value:function(){this.first=null;for(var e=0;e<this._sides;e++)this.addVertex(new l(0,this._radius).rotate(e/this._sides*360).add(this._center))}},{key:"sides",get:function(){return this._sides},set:function(e){this._sides=parseInt(e),this._sides<3&&(this._sides=3),this._calc()}},{key:"center",get:function(){return this._center},set:function(e){this._center=e,this._calc()}},{key:"radius",get:function(){return this._radius},set:function(e){this._radius=e,this._radius<=0&&(this._radius=1),this._calc()}}])&&i(n.prototype,r),a&&i(n,a),t}(a);e.exports=c}]);
//# sourceMappingURL=poly-js.min.js.map